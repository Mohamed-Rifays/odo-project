<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>
  <style>
    body {
      margin: 0;
      font-family: "Inter", Arial, sans-serif;
      background-color: #f9f9f9;
      color: #333;
    }

    /* Navbar */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #2e7d32;
      padding: 12px 20px;
      color: white;
    }

    .logo {
      height: 40px;
    }

    .cart-profile {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 20px;
    }

    .cart {
      cursor: pointer;
      font-size: 22px;
    }

    .profile {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: #1b5e20;
      font-weight: bold;
      font-size: 16px;
      color: white;
      cursor: pointer;
    }

    /* Product Details */
    .product-details {
      max-width: 700px;
      margin: 40px auto;
      padding: 25px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 18px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .product-details h2 {
      font-size: 26px;
      margin-bottom: 15px;
      color: #2e7d32;
    }

    .product-details img {
      width: 100%;
      max-width: 400px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .product-details p {
      font-size: 16px;
      margin: 10px 0;
    }

    .product-details #product-price {
      font-size: 20px;
      font-weight: bold;
      color: #2e7d32;
    }

    /* Button */
    .add-to-cart {
      margin-top: 15px;
      padding: 12px 25px;
      font-size: 16px;
      background: #2e7d32;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s ease-in-out;
    }

    .add-to-cart:hover {
      background: #1b5e20;
    }
  </style>
</head>
<body>
  <header class="navbar">
    <img src="/img/logo.png" alt="Logo" class="logo">
    <div class="cart-profile">
      <!-- âœ… Clickable Cart -->
      <span class="cart" onclick="window.location.href='cart.html'">ðŸ›’</span>
      <!-- âœ… Profile will be updated dynamically -->
      <span class="profile" id="profileBtn">U</span>
    </div>
  </header>

  <main class="product-details">
    <h2 id="product-name">Product Name</h2>
    <img id="product-image" src="/img/placeholder.png" alt="Product Image">
    <p id="product-description">Product description goes here.</p>
    <p id="product-price">$0.00</p>
    <button class="add-to-cart">Add to Cart</button>
  </main>

  <script>
    // ----- Load Product -----
    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");

    const products = [
      { id: 1, name: "Eco Tote Bag", img: "img/product1.jpg", description: "Stylish eco-friendly tote bag.", price: "$15" },
      { id: 2, name: "Recycled Bottle", img: "img/product2.jpg", description: "Reusable bottle made from recycled materials.", price: "$10" },
      { id: 3, name: "Bamboo Toothbrush", img: "img/product3.jpg", description: "Sustainable bamboo toothbrush.", price: "$5" },
      { id: 4, name: "Organic T-Shirt", img: "img/product4.jpg", description: "Comfortable organic cotton t-shirt.", price: "$20" },
    ];

    const product = products.find(p => p.id == productId);

    if (product) {
      document.getElementById("product-name").textContent = product.name;
      document.getElementById("product-image").src = product.img;
      document.getElementById("product-description").textContent = product.description;
      document.getElementById("product-price").textContent = product.price;
    } else {
      document.querySelector(".product-details").innerHTML = "<p>Product not found.</p>";
    }

    // ----- Add to Cart -----
    document.querySelector(".add-to-cart").addEventListener("click", () => {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      const existing = cart.find(item => item.id == product.id);
      if (existing) {
        existing.quantity += 1;
      } else {
        cart.push({ ...product, quantity: 1 });
      }

      localStorage.setItem("cart", JSON.stringify(cart));
      alert("âœ… Added to cart!");
    });

    // ----- Profile Button -----
    const profileBtn = document.getElementById("profileBtn");
    const token = localStorage.getItem("token");

    if (token) {
      // Example fetch current user
      fetch("/api/me", { headers: { "Authorization": "Bearer " + token } })
        .then(res => res.ok ? res.json() : null)
        .then(user => {
          if (user) {
            profileBtn.textContent = user.name ? user.name[0].toUpperCase() : "U";
            profileBtn.onclick = () => window.location.href = "profile.html";
          } else {
            profileBtn.onclick = () => window.location.href = "login.html";
          }
        })
        .catch(() => {
          profileBtn.onclick = () => window.location.href = "login.html";
        });
    } else {
      profileBtn.onclick = () => window.location.href = "login.html";
    }
  </script>
</body>
</html>
